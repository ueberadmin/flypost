var FileUploader={upload:function(s){var id=s.fileElementId;var form=FileUploader.createUploadForm(id,s.fileElementId);var io=FileUploader.createUploadIframe(id,s.secureuri);var frameId="jUploadFrame"+id;var formId="jUploadForm"+id;var fileId="jUploadFile"+id;var requestDone=false;var xml={};var uploadCallback=function(isTimeout){var io=document.getElementById(frameId);try{if(io.contentWindow){xml.responseText=io.contentWindow.document.body?io.contentWindow.document.body.textContent:null;xml.responseXML=io.contentWindow.document.XMLDocument?io.contentWindow.document.XMLDocument:io.contentWindow.document;}else{if(io.contentDocument){xml.responseText=io.contentDocument.document.body?io.contentDocument.document.body.textContent:null;xml.responseXML=io.contentDocument.document.XMLDocument?io.contentDocument.document.XMLDocument:io.contentDocument.document;}}}catch(e){FileUploader.handleError(s,xml,null,"Error getting data from frame "+e);}if(xml||isTimeout=="timeout"){requestDone=true;var status;try{status=isTimeout!="timeout"?"success":"error";if(status!="error"){eval("data = "+xml.responseText);s.callback(data);}else{FileUploader.handleError(s,xml,status,"Error: fileuploader timeout");}}catch(e){status="error";FileUploader.handleError(s,xml,status,"Error parsing JSON ("+xml.responseText+"): "+e);}setTimeout(function(){try{io.parentNode.removeChild(io);form.parentNode.removeChild(form);document.getElementById(s.fileElementId).value="";}catch(e){FileUploader.handleError(s,xml,status,"Remove child error "+e);}},100);xml=null;}};if(s.timeout>0){setTimeout(function(){if(!requestDone){uploadCallback("timeout");}},s.timeout);}try{var form=document.getElementById(formId);form.action=s.url;form.method="POST";form.target=frameId;if(form.encoding){form.encoding="multipart/form-data";}else{form.enctype="multipart/form-data";}form.submit();}catch(e){FileUploader.handleError(s,xml,null,"Error sending form data "+e);}if(window.attachEvent){document.getElementById(frameId).attachEvent("onload",uploadCallback);}else{document.getElementById(frameId).addEventListener("load",uploadCallback,false);}return{abort:function(){}};},handleError:function(c,b,a,d){alert(d);},createUploadIframe:function(d,b){var a="jUploadFrame"+d;if(window.ActiveXObject){var c=document.createElement("iframe");c.id=a;c.name=a;if(typeof b=="boolean"){c.src="javascript:false";}else{if(typeof b=="string"){c.src=b;}}}else{var c=document.createElement("iframe");c.id=a;c.name=a;}c.style.position="absolute";c.style.top="-1000px";c.style.left="-1000px";document.body.appendChild(c);return c;},createUploadForm:function(a,j){var i="jUploadForm"+a;var e="jUploadFile"+a;var h=document.createElement("div");document.body.appendChild(h);h.innerHTML='<form action="" method="POST" name="'+i+'" id="'+i+'" enctype="multipart/form-data"></form>';var b=document.getElementById(i);var f=document.getElementById(j);var g=f.cloneNode(true);f.id=e;var c=f.parentNode;c.insertBefore(g,f);b.appendChild(f);b.style.position="absolute";b.style.top="-1200px";b.style.left="-1200px";document.body.appendChild(b);return b;}};